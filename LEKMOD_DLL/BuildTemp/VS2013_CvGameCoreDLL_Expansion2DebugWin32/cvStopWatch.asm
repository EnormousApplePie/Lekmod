; Listing generated by Microsoft (R) Optimizing Compiler Version 15.00.30729.01 

	TITLE	D:\sources\Lekmod_git\checkout\LEKMOD_DLL\CvGameCoreDLL_Expansion2\cvStopWatch.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRT
INCLUDELIB OLDNAMES

PUBLIC	?ms_ticksPerSecond@cvStopWatch@@0T_LARGE_INTEGER@@A ; cvStopWatch::ms_ticksPerSecond
PUBLIC	?ms_bPerfInit@cvStopWatch@@0_NA			; cvStopWatch::ms_bPerfInit
_BSS	SEGMENT
?ms_ticksPerSecond@cvStopWatch@@0T_LARGE_INTEGER@@A DQ 01H DUP (?) ; cvStopWatch::ms_ticksPerSecond
?ms_bPerfInit@cvStopWatch@@0_NA DB 01H DUP (?)		; cvStopWatch::ms_bPerfInit
	ALIGN	4

_ms_nesting DD	01H DUP (?)
_BSS	ENDS
PUBLIC	?StartPerfTest@cvStopWatch@@QAEXXZ		; cvStopWatch::StartPerfTest
PUBLIC	__real@0000000000000000
PUBLIC	??0cvStopWatch@@QAE@PBD0I_N1@Z			; cvStopWatch::cvStopWatch
EXTRN	__fltused:DWORD
;	COMDAT __real@0000000000000000
; File d:\sources\lekmod_git\checkout\lekmod_dll\cvgamecoredll_expansion2\cvstopwatch.cpp
CONST	SEGMENT
__real@0000000000000000 DQ 00000000000000000r	; 0
; Function compile flags: /Odtp
CONST	ENDS
;	COMDAT ??0cvStopWatch@@QAE@PBD0I_N1@Z
_TEXT	SEGMENT
_this$ = -4						; size = 4
_szName$ = 8						; size = 4
_szLogFile$ = 12					; size = 4
_logFlags$ = 16						; size = 4
_bDisable$ = 20						; size = 1
_bShowNesting$ = 24					; size = 1
??0cvStopWatch@@QAE@PBD0I_N1@Z PROC			; cvStopWatch::cvStopWatch, COMDAT
; _this$ = ecx

; 29   : {

	push	ebp
	mov	ebp, esp
	push	ecx
	mov	DWORD PTR _this$[ebp], ecx
	mov	eax, DWORD PTR _this$[ebp]
	mov	ecx, DWORD PTR _szName$[ebp]
	mov	DWORD PTR [eax], ecx
	mov	edx, DWORD PTR _this$[ebp]
	mov	eax, DWORD PTR _szLogFile$[ebp]
	mov	DWORD PTR [edx+4], eax
	mov	ecx, DWORD PTR _this$[ebp]
	movsd	xmm0, QWORD PTR __real@0000000000000000
	movsd	QWORD PTR [ecx+8], xmm0
	mov	edx, DWORD PTR _this$[ebp]
	mov	eax, DWORD PTR _logFlags$[ebp]
	mov	DWORD PTR [edx+16], eax
	mov	ecx, DWORD PTR _this$[ebp]
	mov	dl, BYTE PTR _bDisable$[ebp]
	mov	BYTE PTR [ecx+25], dl
	mov	eax, DWORD PTR _this$[ebp]
	mov	cl, BYTE PTR _bShowNesting$[ebp]
	mov	BYTE PTR [eax+26], cl

; 30   : 	m_nesting = ms_nesting;

	mov	edx, DWORD PTR _this$[ebp]
	mov	eax, DWORD PTR _ms_nesting
	mov	DWORD PTR [edx+20], eax

; 31   : 	++ms_nesting;

	mov	ecx, DWORD PTR _ms_nesting
	add	ecx, 1
	mov	DWORD PTR _ms_nesting, ecx

; 32   : 	StartPerfTest();

	mov	ecx, DWORD PTR _this$[ebp]
	call	?StartPerfTest@cvStopWatch@@QAEXXZ	; cvStopWatch::StartPerfTest

; 33   : }

	mov	eax, DWORD PTR _this$[ebp]
	mov	esp, ebp
	pop	ebp
	ret	20					; 00000014H
??0cvStopWatch@@QAE@PBD0I_N1@Z ENDP			; cvStopWatch::cvStopWatch
_TEXT	ENDS
PUBLIC	?EndPerfTest@cvStopWatch@@QAEXXZ		; cvStopWatch::EndPerfTest
PUBLIC	??1cvStopWatch@@QAE@XZ				; cvStopWatch::~cvStopWatch
; Function compile flags: /Odtp
;	COMDAT ??1cvStopWatch@@QAE@XZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
??1cvStopWatch@@QAE@XZ PROC				; cvStopWatch::~cvStopWatch, COMDAT
; _this$ = ecx

; 36   : {

	push	ebp
	mov	ebp, esp
	push	ecx
	mov	DWORD PTR _this$[ebp], ecx

; 37   : 	EndPerfTest();

	mov	ecx, DWORD PTR _this$[ebp]
	call	?EndPerfTest@cvStopWatch@@QAEXXZ	; cvStopWatch::EndPerfTest

; 38   : 	--ms_nesting;

	mov	eax, DWORD PTR _ms_nesting
	sub	eax, 1
	mov	DWORD PTR _ms_nesting, eax

; 39   : }

	mov	esp, ebp
	pop	ebp
	ret	0
??1cvStopWatch@@QAE@XZ ENDP				; cvStopWatch::~cvStopWatch
_TEXT	ENDS
PUBLIC	?InitPerfTest@cvStopWatch@@SAXXZ		; cvStopWatch::InitPerfTest
EXTRN	__imp__QueryPerformanceFrequency@4:PROC
; Function compile flags: /Odtp
;	COMDAT ?InitPerfTest@cvStopWatch@@SAXXZ
_TEXT	SEGMENT
?InitPerfTest@cvStopWatch@@SAXXZ PROC			; cvStopWatch::InitPerfTest, COMDAT

; 42   : {

	push	ebp
	mov	ebp, esp

; 43   : 	if(!ms_bPerfInit)

	movzx	eax, BYTE PTR ?ms_bPerfInit@cvStopWatch@@0_NA ; cvStopWatch::ms_bPerfInit
	test	eax, eax
	jne	SHORT $LN2@InitPerfTe

; 44   : 	{
; 45   : 		QueryPerformanceFrequency(&ms_ticksPerSecond);

	push	OFFSET ?ms_ticksPerSecond@cvStopWatch@@0T_LARGE_INTEGER@@A ; cvStopWatch::ms_ticksPerSecond
	call	DWORD PTR __imp__QueryPerformanceFrequency@4

; 46   : 		ms_bPerfInit = true;

	mov	BYTE PTR ?ms_bPerfInit@cvStopWatch@@0_NA, 1 ; cvStopWatch::ms_bPerfInit
$LN2@InitPerfTe:

; 47   : 	}
; 48   : }

	pop	ebp
	ret	0
?InitPerfTest@cvStopWatch@@SAXXZ ENDP			; cvStopWatch::InitPerfTest
_TEXT	ENDS
EXTRN	__imp__QueryPerformanceCounter@4:PROC
; Function compile flags: /Odtp
;	COMDAT ?StartPerfTest@cvStopWatch@@QAEXXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?StartPerfTest@cvStopWatch@@QAEXXZ PROC			; cvStopWatch::StartPerfTest, COMDAT
; _this$ = ecx

; 51   : {

	push	ebp
	mov	ebp, esp
	push	ecx
	mov	DWORD PTR _this$[ebp], ecx

; 52   : 	InitPerfTest();

	call	?InitPerfTest@cvStopWatch@@SAXXZ	; cvStopWatch::InitPerfTest

; 53   : 	QueryPerformanceCounter(&m_oldTimerVal);

	mov	eax, DWORD PTR _this$[ebp]
	add	eax, 32					; 00000020H
	push	eax
	call	DWORD PTR __imp__QueryPerformanceCounter@4

; 54   : 	m_bStarted = true;

	mov	ecx, DWORD PTR _this$[ebp]
	mov	BYTE PTR [ecx+24], 1

; 55   : }

	mov	esp, ebp
	pop	ebp
	ret	0
?StartPerfTest@cvStopWatch@@QAEXXZ ENDP			; cvStopWatch::StartPerfTest
_TEXT	ENDS
PUBLIC	?PerfLog@cvStopWatch@@IAEXPBDN@Z		; cvStopWatch::PerfLog
; Function compile flags: /Odtp
;	COMDAT ?EndPerfTest@cvStopWatch@@QAEXXZ
_TEXT	SEGMENT
_this$ = -28						; size = 4
_dtTime$ = -24						; size = 8
_newTimerVal$ = -16					; size = 8
_dTicksPerSecond$ = -8					; size = 8
?EndPerfTest@cvStopWatch@@QAEXXZ PROC			; cvStopWatch::EndPerfTest, COMDAT
; _this$ = ecx

; 58   : {

	push	ebp
	mov	ebp, esp
	sub	esp, 28					; 0000001cH
	mov	DWORD PTR _this$[ebp], ecx

; 59   : 	if(!m_bStarted)

	mov	eax, DWORD PTR _this$[ebp]
	movzx	ecx, BYTE PTR [eax+24]
	test	ecx, ecx
	jne	SHORT $LN1@EndPerfTes

; 60   : 		return;

	jmp	SHORT $LN2@EndPerfTes
$LN1@EndPerfTes:

; 61   : 
; 62   : 	LARGE_INTEGER newTimerVal;
; 63   : 	QueryPerformanceCounter(&newTimerVal);

	lea	edx, DWORD PTR _newTimerVal$[ebp]
	push	edx
	call	DWORD PTR __imp__QueryPerformanceCounter@4

; 64   : 
; 65   : #ifdef AUI_STOPWATCH_SUBTRACT_BEFORE_DELTA_CAST
; 66   : 	double dtTime = (double)(newTimerVal.QuadPart - m_oldTimerVal.QuadPart);
; 67   : #else
; 68   : 	double dtTime = (double)newTimerVal.QuadPart - m_oldTimerVal.QuadPart;

	fild	QWORD PTR _newTimerVal$[ebp]
	mov	eax, DWORD PTR _this$[ebp]
	fild	QWORD PTR [eax+32]
	fsubp	ST(1), ST(0)
	fstp	QWORD PTR _dtTime$[ebp]

; 69   : #endif
; 70   : 	double dTicksPerSecond = (double)ms_ticksPerSecond.QuadPart;

	fild	QWORD PTR ?ms_ticksPerSecond@cvStopWatch@@0T_LARGE_INTEGER@@A ; cvStopWatch::ms_ticksPerSecond
	fstp	QWORD PTR _dTicksPerSecond$[ebp]

; 71   : 
; 72   : 	m_dtseconds = dtTime/dTicksPerSecond;

	movsd	xmm0, QWORD PTR _dtTime$[ebp]
	divsd	xmm0, QWORD PTR _dTicksPerSecond$[ebp]
	mov	ecx, DWORD PTR _this$[ebp]
	movsd	QWORD PTR [ecx+8], xmm0

; 73   : 
; 74   : 	PerfLog(m_szName, m_dtseconds);

	mov	edx, DWORD PTR _this$[ebp]
	sub	esp, 8
	fld	QWORD PTR [edx+8]
	fstp	QWORD PTR [esp]
	mov	eax, DWORD PTR _this$[ebp]
	mov	ecx, DWORD PTR [eax]
	push	ecx
	mov	ecx, DWORD PTR _this$[ebp]
	call	?PerfLog@cvStopWatch@@IAEXPBDN@Z	; cvStopWatch::PerfLog
$LN2@EndPerfTes:

; 75   : }

	mov	esp, ebp
	pop	ebp
	ret	0
?EndPerfTest@cvStopWatch@@QAEXXZ ENDP			; cvStopWatch::EndPerfTest
_TEXT	ENDS
PUBLIC	?GetDeltaInSeconds@cvStopWatch@@QBENXZ		; cvStopWatch::GetDeltaInSeconds
; Function compile flags: /Odtp
;	COMDAT ?GetDeltaInSeconds@cvStopWatch@@QBENXZ
_TEXT	SEGMENT
_this$ = -4						; size = 4
?GetDeltaInSeconds@cvStopWatch@@QBENXZ PROC		; cvStopWatch::GetDeltaInSeconds, COMDAT
; _this$ = ecx

; 78   : {

	push	ebp
	mov	ebp, esp
	push	ecx
	mov	DWORD PTR _this$[ebp], ecx

; 79   : 	return m_dtseconds;

	mov	eax, DWORD PTR _this$[ebp]
	fld	QWORD PTR [eax+8]

; 80   : }

	mov	esp, ebp
	pop	ebp
	ret	0
?GetDeltaInSeconds@cvStopWatch@@QBENXZ ENDP		; cvStopWatch::GetDeltaInSeconds
_TEXT	ENDS
PUBLIC	??_C@_08DNFELEPF@?0?5?$CFs?0?5?$CFf?$AA@	; `string'
PUBLIC	??_C@_0P@MIACEJBC@?0?5?$CFd?0?5?$CFs?0?$CFs?5?$CFf?$AA@ ; `string'
PUBLIC	??_C@_0N@MKBLEILA@?0?5?$CFd?0?5?$CFs?0?5?$CFf?$AA@ ; `string'
PUBLIC	??_C@_0O@CJLLEALO@stopwatch?4log?$AA@		; `string'
EXTRN	?GetInstance@FILogFileMgr@@SAAAV1@XZ:PROC	; FILogFileMgr::GetInstance
;	COMDAT ??_C@_08DNFELEPF@?0?5?$CFs?0?5?$CFf?$AA@
CONST	SEGMENT
??_C@_08DNFELEPF@?0?5?$CFs?0?5?$CFf?$AA@ DB ', %s, %f', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0P@MIACEJBC@?0?5?$CFd?0?5?$CFs?0?$CFs?5?$CFf?$AA@
CONST	SEGMENT
??_C@_0P@MIACEJBC@?0?5?$CFd?0?5?$CFs?0?$CFs?5?$CFf?$AA@ DB ', %d, %s,%s %'
	DB	'f', 00H					; `string'
CONST	ENDS
;	COMDAT ?ms_nestingOffset@?M@??PerfLog@cvStopWatch@@IAEXPBDN@Z@4QBDB
CONST	SEGMENT
?ms_nestingOffset@?M@??PerfLog@cvStopWatch@@IAEXPBDN@Z@4QBDB DB ',,,,,,,,'
	DB	',,,,,,,,,,,,', 00H				; `cvStopWatch::PerfLog'::`12'::ms_nestingOffset
CONST	ENDS
;	COMDAT ??_C@_0N@MKBLEILA@?0?5?$CFd?0?5?$CFs?0?5?$CFf?$AA@
CONST	SEGMENT
??_C@_0N@MKBLEILA@?0?5?$CFd?0?5?$CFs?0?5?$CFf?$AA@ DB ', %d, %s, %f', 00H ; `string'
CONST	ENDS
;	COMDAT ??_C@_0O@CJLLEALO@stopwatch?4log?$AA@
CONST	SEGMENT
??_C@_0O@CJLLEALO@stopwatch?4log?$AA@ DB 'stopwatch.log', 00H ; `string'
; Function compile flags: /Odtp
CONST	ENDS
;	COMDAT ?PerfLog@cvStopWatch@@IAEXPBDN@Z
_TEXT	SEGMENT
tv164 = -44						; size = 4
tv155 = -40						; size = 4
tv138 = -36						; size = 4
tv129 = -32						; size = 4
tv147 = -28						; size = 4
tv87 = -24						; size = 4
tv78 = -20						; size = 4
tv70 = -16						; size = 4
_this$ = -12						; size = 4
_MAX_NESTING$216739 = -8				; size = 4
_szLogFile$216733 = -4					; size = 4
_szName$ = 8						; size = 4
_dtSeconds$ = 12					; size = 8
?PerfLog@cvStopWatch@@IAEXPBDN@Z PROC			; cvStopWatch::PerfLog, COMDAT
; _this$ = ecx

; 83   : {

	push	ebp
	mov	ebp, esp
	sub	esp, 44					; 0000002cH
	mov	DWORD PTR _this$[ebp], ecx

; 84   : 	if (!m_bDisable)

	mov	eax, DWORD PTR _this$[ebp]
	movzx	ecx, BYTE PTR [eax+25]
	test	ecx, ecx
	jne	$LN1@PerfLog

; 85   : 	{
; 86   : 		const char* szLogFile = (m_szLogFile == NULL)? "stopwatch.log" : m_szLogFile;

	mov	edx, DWORD PTR _this$[ebp]
	cmp	DWORD PTR [edx+4], 0
	jne	SHORT $LN8@PerfLog
	mov	DWORD PTR tv70[ebp], OFFSET ??_C@_0O@CJLLEALO@stopwatch?4log?$AA@
	jmp	SHORT $LN9@PerfLog
$LN8@PerfLog:
	mov	eax, DWORD PTR _this$[ebp]
	mov	ecx, DWORD PTR [eax+4]
	mov	DWORD PTR tv70[ebp], ecx
$LN9@PerfLog:
	mov	edx, DWORD PTR tv70[ebp]
	mov	DWORD PTR _szLogFile$216733[ebp], edx

; 87   : 		if (m_bShowNesting)

	mov	eax, DWORD PTR _this$[ebp]
	movzx	ecx, BYTE PTR [eax+26]
	test	ecx, ecx
	je	$LN4@PerfLog

; 88   : 		{
; 89   : 			if (m_nesting == 0)

	mov	edx, DWORD PTR _this$[ebp]
	cmp	DWORD PTR [edx+20], 0
	jne	SHORT $LN3@PerfLog

; 90   : 				LOGFILEMGR.GetLog(szLogFile, m_logFlags)->Msg(", %d, %s, %f", m_nesting, szName, dtSeconds);

	call	?GetInstance@FILogFileMgr@@SAAAV1@XZ	; FILogFileMgr::GetInstance
	mov	DWORD PTR tv78[ebp], eax
	push	0
	mov	eax, DWORD PTR _this$[ebp]
	mov	ecx, DWORD PTR [eax+16]
	push	ecx
	mov	edx, DWORD PTR _szLogFile$216733[ebp]
	push	edx
	mov	eax, DWORD PTR tv78[ebp]
	mov	edx, DWORD PTR [eax]
	mov	ecx, DWORD PTR tv78[ebp]
	mov	eax, DWORD PTR [edx+12]
	call	eax
	mov	DWORD PTR tv87[ebp], eax
	sub	esp, 8
	fld	QWORD PTR _dtSeconds$[ebp]
	fstp	QWORD PTR [esp]
	mov	ecx, DWORD PTR _szName$[ebp]
	push	ecx
	mov	edx, DWORD PTR _this$[ebp]
	mov	eax, DWORD PTR [edx+20]
	push	eax
	push	OFFSET ??_C@_0N@MKBLEILA@?0?5?$CFd?0?5?$CFs?0?5?$CFf?$AA@
	mov	ecx, DWORD PTR tv87[ebp]
	push	ecx
	mov	edx, DWORD PTR tv87[ebp]
	mov	eax, DWORD PTR [edx]
	mov	ecx, DWORD PTR [eax]
	call	ecx
	add	esp, 24					; 00000018H

; 91   : 			else

	jmp	SHORT $LN2@PerfLog
$LN3@PerfLog:

; 92   : 			{
; 93   : 				const int MAX_NESTING = 20;

	mov	DWORD PTR _MAX_NESTING$216739[ebp], 20	; 00000014H

; 94   : 				static const char ms_nestingOffset[] = ",,,,,,,,,,,,,,,,,,,,";
; 95   : 				LOGFILEMGR.GetLog(szLogFile, m_logFlags)->Msg(", %d, %s,%s %f", m_nesting, szName, ((m_nesting < MAX_NESTING)?(&ms_nestingOffset[MAX_NESTING - m_nesting]):(&ms_nestingOffset[0])), dtSeconds);

	mov	edx, DWORD PTR _this$[ebp]
	cmp	DWORD PTR [edx+20], 20			; 00000014H
	jge	SHORT $LN10@PerfLog
	mov	eax, DWORD PTR _this$[ebp]
	mov	ecx, 20					; 00000014H
	sub	ecx, DWORD PTR [eax+20]
	add	ecx, OFFSET ?ms_nestingOffset@?M@??PerfLog@cvStopWatch@@IAEXPBDN@Z@4QBDB
	mov	DWORD PTR tv147[ebp], ecx
	jmp	SHORT $LN11@PerfLog
$LN10@PerfLog:
	mov	DWORD PTR tv147[ebp], OFFSET ?ms_nestingOffset@?M@??PerfLog@cvStopWatch@@IAEXPBDN@Z@4QBDB
$LN11@PerfLog:
	call	?GetInstance@FILogFileMgr@@SAAAV1@XZ	; FILogFileMgr::GetInstance
	mov	DWORD PTR tv129[ebp], eax
	push	0
	mov	edx, DWORD PTR _this$[ebp]
	mov	eax, DWORD PTR [edx+16]
	push	eax
	mov	ecx, DWORD PTR _szLogFile$216733[ebp]
	push	ecx
	mov	edx, DWORD PTR tv129[ebp]
	mov	eax, DWORD PTR [edx]
	mov	ecx, DWORD PTR tv129[ebp]
	mov	edx, DWORD PTR [eax+12]
	call	edx
	mov	DWORD PTR tv138[ebp], eax
	sub	esp, 8
	fld	QWORD PTR _dtSeconds$[ebp]
	fstp	QWORD PTR [esp]
	mov	eax, DWORD PTR tv147[ebp]
	push	eax
	mov	ecx, DWORD PTR _szName$[ebp]
	push	ecx
	mov	edx, DWORD PTR _this$[ebp]
	mov	eax, DWORD PTR [edx+20]
	push	eax
	push	OFFSET ??_C@_0P@MIACEJBC@?0?5?$CFd?0?5?$CFs?0?$CFs?5?$CFf?$AA@
	mov	ecx, DWORD PTR tv138[ebp]
	push	ecx
	mov	edx, DWORD PTR tv138[ebp]
	mov	eax, DWORD PTR [edx]
	mov	ecx, DWORD PTR [eax]
	call	ecx
	add	esp, 28					; 0000001cH
$LN2@PerfLog:

; 96   : 			}
; 97   : 		}
; 98   : 		else

	jmp	SHORT $LN1@PerfLog
$LN4@PerfLog:

; 99   : 			LOGFILEMGR.GetLog(szLogFile, m_logFlags)->Msg(", %s, %f", szName, dtSeconds);

	call	?GetInstance@FILogFileMgr@@SAAAV1@XZ	; FILogFileMgr::GetInstance
	mov	DWORD PTR tv155[ebp], eax
	push	0
	mov	edx, DWORD PTR _this$[ebp]
	mov	eax, DWORD PTR [edx+16]
	push	eax
	mov	ecx, DWORD PTR _szLogFile$216733[ebp]
	push	ecx
	mov	edx, DWORD PTR tv155[ebp]
	mov	eax, DWORD PTR [edx]
	mov	ecx, DWORD PTR tv155[ebp]
	mov	edx, DWORD PTR [eax+12]
	call	edx
	mov	DWORD PTR tv164[ebp], eax
	sub	esp, 8
	fld	QWORD PTR _dtSeconds$[ebp]
	fstp	QWORD PTR [esp]
	mov	eax, DWORD PTR _szName$[ebp]
	push	eax
	push	OFFSET ??_C@_08DNFELEPF@?0?5?$CFs?0?5?$CFf?$AA@
	mov	ecx, DWORD PTR tv164[ebp]
	push	ecx
	mov	edx, DWORD PTR tv164[ebp]
	mov	eax, DWORD PTR [edx]
	mov	ecx, DWORD PTR [eax]
	call	ecx
	add	esp, 20					; 00000014H
$LN1@PerfLog:

; 100  : 	}
; 101  : }

	mov	esp, ebp
	pop	ebp
	ret	12					; 0000000cH
?PerfLog@cvStopWatch@@IAEXPBDN@Z ENDP			; cvStopWatch::PerfLog
_TEXT	ENDS
END
